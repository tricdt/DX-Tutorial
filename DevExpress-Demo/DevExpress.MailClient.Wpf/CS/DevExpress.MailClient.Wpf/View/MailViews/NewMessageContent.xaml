<UserControl x:Class="DevExpress.MailClient.View.NewMessageContent"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
             xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars"
             xmlns:dxre="http://schemas.devexpress.com/winfx/2008/xaml/richedit"
             xmlns:dxr="http://schemas.devexpress.com/winfx/2008/xaml/ribbon"
             xmlns:dxt="http://schemas.devexpress.com/winfx/2008/xaml/core/themekeys"
             xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
             xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm"
             xmlns:viewmodel="clr-namespace:DevExpress.MailClient.ViewModel"
             mc:Ignorable="d" d:DataContext="{dxmvvm:ViewModelSource viewmodel:MailViewModel}"
             d:DesignHeight="350" d:DesignWidth="850">
    <UserControl.Resources>
        <dxre:RichEditUICommand x:Key="commands" />
        <dxre:RichEditStringIdConverter x:Key="stringIdConverter" />
        <dxre:MhtToContentConverter x:Key="MhtToContentConverter"/>
        <dxmvvm:BooleanNegationConverter x:Key="BooleanNegationConverter"/>
    </UserControl.Resources>
    <dxmvvm:Interaction.Behaviors>
        <dx:DXMessageBoxService/>
        <dxmvvm:CurrentWindowService ClosingCommand="{Binding SaveMessageOnClosingConfirmationCommand}"/>
    </dxmvvm:Interaction.Behaviors>
    <dxb:BarManager Name="barManager">
        <dxb:BarManager.Items>
            <dxre:BarSplitButtonColorEditItem Command="{Binding FormatFontBackColor, Mode=OneTime, Source={StaticResource commands}}" x:Name="biFormatFontBackColor" Glyph="{dx:DXImage SvgImages/RichEdit/FloatingObjectFillColor.svg}" RibbonStyle="SmallWithoutText">
                <dxre:BarSplitButtonColorEditItem.PopupControl>
                    <dxb:PopupControlContainer>
                        <dxe:ColorEdit EditValue="{Binding EditValue, ElementName=biFormatFontBackColor, Mode=TwoWay}" ShowBorder="False" ColumnCount="5" ChipSize="Large" ChipMargin="3" ShowDefaultColorButton="false" ShowMoreColorsButton="False" ShowNoColorButton="True">
                            <dxe:ColorEdit.Palettes>
                                <dxre:CharactersBackgroundColorPaletteCollection />
                            </dxe:ColorEdit.Palettes>
                        </dxe:ColorEdit>
                    </dxb:PopupControlContainer>
                </dxre:BarSplitButtonColorEditItem.PopupControl>
            </dxre:BarSplitButtonColorEditItem>
            <dxre:BarSplitButtonColorEditItem Command="{Binding Path=FormatFontForeColor, Mode=OneTime, Source={StaticResource commands}}" Name="biFormatFontForeColor" Glyph="{dx:DXImage SvgImages/RichEdit/FontColor.svg}" RibbonStyle="SmallWithoutText">
                <dxre:BarSplitButtonColorEditItem.PopupControl>
                    <dxb:PopupControlContainer>
                        <dxe:ColorEdit EditValue="{Binding ElementName=biFormatFontForeColor, Mode=TwoWay, Path=EditValue}" ShowBorder="False" />
                    </dxb:PopupControlContainer>
                </dxre:BarSplitButtonColorEditItem.PopupControl>
            </dxre:BarSplitButtonColorEditItem>
            <dxre:BarSplitButtonColorEditItem Command="{Binding FormatParagraphBackColor, Mode=OneTime, Source={StaticResource commands}}" x:Name="biFormatParagraphBackColor" Glyph="{dx:DXImage SvgImages/RichEdit/FloatingObjectFillColor.svg}" RibbonStyle="SmallWithoutText">
                <dxre:BarSplitButtonColorEditItem.PopupControl>
                    <dxb:PopupControlContainer>
                        <UserControl>
                            <dxe:ColorEdit EditValue="{Binding EditValue, ElementName=biFormatParagraphBackColor, Mode=TwoWay}" ShowBorder="False" ShowDefaultColorButton="False" ShowNoColorButton="True" />
                        </UserControl>
                    </dxb:PopupControlContainer>
                </dxre:BarSplitButtonColorEditItem.PopupControl>
            </dxre:BarSplitButtonColorEditItem>
        </dxb:BarManager.Items>
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <dxr:RibbonControl x:Name="ribbon" Grid.Row="0" Grid.ColumnSpan="2" RibbonStyle="Office2010">
                <dxr:RibbonControl.ToolbarItems>
                    <dxb:BarButtonItem Command="{Binding EditUndo, Mode=OneTime, Source={StaticResource commands}}" RibbonStyle="Large" Glyph="{dx:DXImage SvgImages/RichEdit/Undo.svg}" />
                    <dxb:BarButtonItem Command="{Binding EditRedo, Mode=OneTime, Source={StaticResource commands}}" RibbonStyle="Large" Glyph="{dx:DXImage SvgImages/RichEdit/Redo.svg}" />
                </dxr:RibbonControl.ToolbarItems>
                <dxr:RibbonControl.ApplicationMenu>
                    <dxr:ApplicationMenu RightPaneWidth="100" ShowRightPane="false">
                        <dxr:ApplicationMenu.Items>
                            <dxb:BarButtonItem Content="Save message to drafts" Command="{Binding SaveMessageCommand}" LargeGlyph="{dx:DXImage SvgImages/Save/Save.svg}"/>
                            <dxb:BarButtonItem Content="Close" Command="{Binding CloseMessageWindowCommand}" LargeGlyph="{dx:DXImage SvgImages/Outlook Inspired/Close.svg}"/>
                        </dxr:ApplicationMenu.Items>
                    </dxr:ApplicationMenu>
                </dxr:RibbonControl.ApplicationMenu>
                <dxr:RibbonDefaultPageCategory>
                    <dxr:RibbonPage Caption="Home" Name="pageHome">
                        <dxr:RibbonPageGroup Caption="Send" ShowCaptionButton="False">
                            <dxb:BarButtonItem Content="Send message" Command="{Binding SendMessageCommand}" LargeGlyph="{dx:DXImage SvgImages/Scheduling/Forward.svg}"
                                               IsEnabled="{Binding (Validation.HasError), ElementName=emailAddressToEdit, Converter={StaticResource BooleanNegationConverter}}"/>
                        </dxr:RibbonPageGroup>
                        <dxr:RibbonPageGroup Caption="Clipboard" ShowCaptionButton="False">
                            <dxb:BarButtonItem Command="{Binding EditPaste, Mode=OneTime, Source={StaticResource commands}}" Name="biEditPaste" Glyph="{dx:DXImage SvgImages/Edit/Paste.svg}" RibbonStyle="SmallWithText" />
                            <dxb:BarButtonItem Command="{Binding EditCut, Mode=OneTime, Source={StaticResource commands}}" Name="biEditCut" Glyph="{dx:DXImage SvgImages/Edit/Cut.svg}" RibbonStyle="SmallWithText" />
                            <dxb:BarButtonItem Command="{Binding EditCopy, Mode=OneTime, Source={StaticResource commands}}" Name="biEditCopy" Glyph="{dx:DXImage SvgImages/Edit/Copy.svg}" RibbonStyle="SmallWithText" />
                        </dxr:RibbonPageGroup>
                        <dxr:RibbonPageGroup Caption="Font" CaptionButtonCommand="{Binding FormatFont, Mode=OneTime, Source={StaticResource commands}}">
                            <dxr:BarButtonGroup>
                                <dxb:BarEditItem Command="{Binding FormatFontName, Mode=OneTime, Source={StaticResource commands}}" Content="" EditWidth="150">
                                    <dxb:BarEditItem.EditSettings>
                                        <dxre:FontComboBoxEditSettings />
                                    </dxb:BarEditItem.EditSettings>
                                </dxb:BarEditItem>
                                <dxb:BarEditItem Command="{Binding FormatFontSize, Mode=OneTime, Source={StaticResource commands}}" Content="" EditWidth="50">
                                    <dxb:BarEditItem.EditSettings>
                                        <dxre:RichEditFontSizeComboBoxEditSettings RichEditControl="{Binding ElementName=richEdit}" />
                                    </dxb:BarEditItem.EditSettings>
                                </dxb:BarEditItem>
                            </dxr:BarButtonGroup>
                            <dxr:BarButtonGroup>
                                <dxb:BarButtonItem Command="{Binding FormatIncreaseFontSize, Mode=OneTime, Source={StaticResource commands}}" Glyph="{dx:DXImage SvgImages/RichEdit/FontSizeIncrease.svg}" RibbonStyle="SmallWithoutText"/>
                                <dxb:BarButtonItem Command="{Binding FormatDecreaseFontSize, Mode=OneTime, Source={StaticResource commands}}" Glyph="{dx:DXImage SvgImages/RichEdit/FontSizeDecrease.svg}" RibbonStyle="SmallWithoutText"/>
                            </dxr:BarButtonGroup>
                            <dxr:BarButtonGroup>
                                <dxb:BarButtonItem Command="{Binding FormatClearFormatting, Mode=OneTime, Source={StaticResource commands}}" Glyph="{dx:DXImage SvgImages/RichEdit/RichEditClearFormatting.svg}"/>
                            </dxr:BarButtonGroup>
                            <dxr:BarButtonGroup>
                                <dxb:BarCheckItem Command="{Binding FormatFontBold, Mode=OneTime, Source={StaticResource commands}}" Glyph="{dx:DXImage SvgImages/Format/Bold.svg}" RibbonStyle="SmallWithoutText"/>
                                <dxb:BarCheckItem Command="{Binding FormatFontItalic, Mode=OneTime, Source={StaticResource commands}}" RibbonStyle="SmallWithoutText" Glyph="{dx:DXImage SvgImages/Format/Italic.svg}"/>
                                <dxb:BarCheckItem Command="{Binding FormatFontUnderline, Mode=OneTime, Source={StaticResource commands}}" RibbonStyle="SmallWithoutText" Glyph="{dx:DXImage SvgImages/Format/Underline.svg}"/>
                                <dxb:BarCheckItem Command="{Binding FormatFontDoubleUnderline, Mode=OneTime, Source={StaticResource commands}}" RibbonStyle="SmallWithoutText" Glyph="{dx:DXImage SvgImages/Format/UnderlineDouble.svg}"/>
                                <dxb:BarCheckItem Command="{Binding FormatFontStrikeout, Mode=OneTime, Source={StaticResource commands}}" Glyph="{dx:DXImage SvgImages/Format/Strikeout.svg}" RibbonStyle="SmallWithoutText"/>
                                <dxb:BarCheckItem Command="{Binding FormatFontDoubleStrikeout, Mode=OneTime, Source={StaticResource commands}}" RibbonStyle="SmallWithoutText" Glyph="{dx:DXImage SvgImages/Format/StrikeoutDouble.svg}"/>
                                <dxb:BarCheckItem Command="{Binding FormatFontSuperscript, Mode=OneTime, Source={StaticResource commands}}" Glyph="{dx:DXImage SvgImages/Format/Superscript.svg}" RibbonStyle="SmallWithoutText"/>
                                <dxb:BarCheckItem Command="{Binding FormatFontSubscript, Mode=OneTime, Source={StaticResource commands}}" Glyph="{dx:DXImage SvgImages/Format/Subscript.svg}" RibbonStyle="SmallWithoutText"/>
                                <dxb:BarSubItem Command="{Binding EditChangeCase, Mode=OneTime, Source={StaticResource commands}}" Glyph="{dx:DXImage SvgImages/RichEdit/ChangeTextCase.svg}" RibbonStyle="SmallWithoutText">
                                    <dxb:BarButtonItem Command="{Binding EditMakeUpperCase, Mode=OneTime, Source={StaticResource commands}}"/>
                                    <dxb:BarButtonItem Command="{Binding EditMakeLowerCase, Mode=OneTime, Source={StaticResource commands}}"/>
                                    <dxb:BarButtonItem Command="{Binding EditToggleCase, Mode=OneTime, Source={StaticResource commands}}"/>
                                </dxb:BarSubItem>
                            </dxr:BarButtonGroup>
                            <dxr:BarButtonGroup Name="biFontColor">
                                <dxr:BarButtonGroup.ItemLinks>
                                    <dxre:BarSplitButtonColorEditItemLink BarItemName="biFormatFontBackColor" />
                                    <dxre:BarSplitButtonColorEditItemLink BarItemName="biFormatFontForeColor" />
                                </dxr:BarButtonGroup.ItemLinks>
                            </dxr:BarButtonGroup>
                        </dxr:RibbonPageGroup>
                        <dxr:RibbonPageGroup Caption="Paragraph" CaptionButtonCommand="{Binding FormatParagraph, Mode=OneTime, Source={StaticResource commands}}">
                            <dxr:BarButtonGroup>
                                <dxb:BarCheckItem Command="{Binding FormatBulletedList, Mode=OneTime, Source={StaticResource commands}}" LargeGlyph="{dx:DXImage SvgImages/RichEdit/ListBullets.svg}" RibbonStyle="SmallWithoutText" />
                                <dxb:BarCheckItem Command="{Binding FormatNumberingList, Mode=OneTime, Source={StaticResource commands}}" Glyph="{dx:DXImage SvgImages/RichEdit/ListNumbers.svg}" RibbonStyle="SmallWithoutText" />
                                <dxb:BarCheckItem Command="{Binding FormatMultilevelList, Mode=OneTime, Source={StaticResource commands}}" Glyph="{dx:DXImage SvgImages/RichEdit/ListMultilevel.svg}" RibbonStyle="SmallWithoutText"/>
                            </dxr:BarButtonGroup>
                            <dxr:BarButtonGroup>
                                <dxb:BarButtonItem Command="{Binding FormatDecreaseIndent, Mode=OneTime, Source={StaticResource commands}}" Glyph="{dx:DXImage SvgImages/Format/IndentDecrease.svg}" RibbonStyle="SmallWithoutText"/>
                                <dxb:BarButtonItem Command="{Binding FormatIncreaseIndent, Mode=OneTime, Source={StaticResource commands}}" Glyph="{dx:DXImage SvgImages/Format/IndentIncrease.svg}"/>
                            </dxr:BarButtonGroup>
                            <dxr:BarButtonGroup>
                                <dxb:BarCheckItem Command="{Binding ViewShowWhitespace, Mode=OneTime, Source={StaticResource commands}}" Glyph="{dx:DXImage SvgImages/RichEdit/ShowHidden.svg}" RibbonStyle="SmallWithoutText"/>
                            </dxr:BarButtonGroup>
                            <dxr:BarButtonGroup>
                                <dxb:BarCheckItem Command="{Binding FormatParagraphAlignLeft, Mode=OneTime, Source={StaticResource commands}}" Glyph="{dx:DXImage SvgImages/Format/AlignLeft.svg}" RibbonStyle="SmallWithoutText"/>
                                <dxb:BarCheckItem Command="{Binding FormatParagraphAlignCenter, Mode=OneTime, Source={StaticResource commands}}" Glyph="{dx:DXImage SvgImages/Format/AlignCenter.svg}" RibbonStyle="SmallWithoutText"/>
                                <dxb:BarCheckItem Command="{Binding FormatParagraphAlignRight, Mode=OneTime, Source={StaticResource commands}}" Glyph="{dx:DXImage SvgImages/Format/AlignRight.svg}" RibbonStyle="SmallWithoutText"/>
                                <dxb:BarCheckItem Command="{Binding FormatParagraphAlignJustify, Mode=OneTime, Source={StaticResource commands}}" Glyph="{dx:DXImage SvgImages/Format/AlignJustify.svg}" RibbonStyle="SmallWithText"/>
                            </dxr:BarButtonGroup>
                            <dxr:BarButtonGroup>
                                <dxb:BarSubItem Command="{Binding FormatParagraphLineSpacing, Mode=OneTime, Source={StaticResource commands}}" Glyph="{dx:DXImage SvgImages/RichEdit/LineSpacing.svg}" RibbonStyle="SmallWithText">
                                    <dxb:BarCheckItem Command="{Binding FormatParagraphLineSpacingSingle, Mode=OneTime, Source={StaticResource commands}}"/>
                                    <dxb:BarCheckItem Command="{Binding FormatParagraphLineSpacingSesquialteral, Mode=OneTime, Source={StaticResource commands}}"/>
                                    <dxb:BarCheckItem Command="{Binding FormatParagraphLineSpacingDouble, Mode=OneTime, Source={StaticResource commands}}"/>
                                    <dxb:BarButtonItem Command="{Binding FormatParagraphLineSpacingCustomize, Mode=OneTime, Source={StaticResource commands}}"/>
                                    <dxb:BarButtonItem Command="{Binding FormatParagraphAddSpacingBefore, Mode=OneTime, Source={StaticResource commands}}"/>
                                    <dxb:BarButtonItem Command="{Binding FormatParagraphRemoveSpacingBefore, Mode=OneTime, Source={StaticResource commands}}"/>
                                    <dxb:BarButtonItem Command="{Binding FormatParagraphAddSpacingAfter, Mode=OneTime, Source={StaticResource commands}}"/>
                                    <dxb:BarButtonItem Command="{Binding FormatParagraphRemoveSpacingAfter, Mode=OneTime, Source={StaticResource commands}}"/>
                                </dxb:BarSubItem>
                                <dxre:BarSplitButtonColorEditItemLink BarItemName="biFormatParagraphBackColor"/>
                            </dxr:BarButtonGroup>
                        </dxr:RibbonPageGroup>
                        <dxr:RibbonPageGroup Caption="Editing" ShowCaptionButton="False">
                            <dxb:BarButtonItem Command="{Binding EditFind, Mode=OneTime, Source={StaticResource commands}}" LargeGlyph="{dx:DXImage SvgImages/Find/Find.svg}" Glyph="{dx:DXImage SvgImages/Find/Find.svg}"/>
                            <dxb:BarButtonItem Command="{Binding EditReplace, Mode=OneTime, Source={StaticResource commands}}" LargeGlyph="{dx:DXImage SvgImages/RichEdit/Replace.svg}" Glyph="{dx:DXImage SvgImages/RichEdit/Replace.svg}"/>
                        </dxr:RibbonPageGroup>
                        <dxr:RibbonPageGroup Caption="Proofing">
                            <dxb:BarButtonItem Command="{Binding CheckSpelling, Mode=OneTime, Source={StaticResource commands}}" RibbonStyle="Large" Glyph="{dx:DXImage SvgImages/RichEdit/SpellCheck.svg}" LargeGlyph="{dx:DXImage SvgImages/RichEdit/SpellCheck.svg}"/>
                        </dxr:RibbonPageGroup>
                    </dxr:RibbonPage>
                    <dxr:RibbonPage Caption="Insert" Name="pageInsert">
                        <dxr:RibbonPageGroup Caption="Tables" ShowCaptionButton="False">
                            <dxb:BarButtonItem Command="{Binding InsertTable, Mode=OneTime, Source={StaticResource commands}}" LargeGlyph="{dx:DXImage SvgImages/RichEdit/InsertTable.svg}" Glyph="{dx:DXImage SvgImages/RichEdit/InsertTable.svg}"/>
                        </dxr:RibbonPageGroup>
                        <dxr:RibbonPageGroup Caption="Illustrations" ShowCaptionButton="False">
                            <dxb:BarButtonItem Command="{Binding InsertPicture, Mode=OneTime, Source={StaticResource commands}}" LargeGlyph="{dx:DXImage SvgImages/RichEdit/InsertImage.svg}" Glyph="{dx:DXImage SvgImages/RichEdit/InsertImage.svg}"/>
                            <dxb:BarButtonItem Command="{Binding InsertFloatingPicture, Mode=OneTime, Source={StaticResource commands}}" LargeGlyph="{dx:DXImage SvgImages/RichEdit/InsertFloatingObjectImage.svg}" Glyph="{dx:DXImage SvgImages/RichEdit/InsertFloatingObjectImage.svg}"/>
                        </dxr:RibbonPageGroup>
                        <dxr:RibbonPageGroup Caption="Links" ShowCaptionButton="False">
                            <dxb:BarButtonItem Command="{Binding InsertHyperlink, Mode=OneTime, Source={StaticResource commands}}" LargeGlyph="{dx:DXImage SvgImages/Business Objects/BO_Localization.svg}" Glyph="{dx:DXImage SvgImages/Business Objects/BO_Localization.svg}"/>
                        </dxr:RibbonPageGroup>
                        <dxr:RibbonPageGroup Caption="{Binding Source={StaticResource stringIdConverter}, ConverterParameter=Caption_GroupText, Converter={StaticResource stringIdConverter}, Mode=OneTime}" Name="grpText" ShowCaptionButton="False">
                            <dxb:BarButtonItem Command="{Binding InsertTextBox, Mode=OneTime, Source={StaticResource commands}}" LargeGlyph="{dx:DXImage SvgImages/RichEdit/InsertTextBox.svg}" Glyph="{dx:DXImage SvgImages/RichEdit/InsertTextBox.svg}"/>
                        </dxr:RibbonPageGroup>
                        <dxr:RibbonPageGroup Caption="Symbols" ShowCaptionButton="False">
                            <dxb:BarButtonItem Command="{Binding InsertSymbol, Mode=OneTime, Source={StaticResource commands}}" Glyph="{dx:DXImage SvgImages/RichEdit/Symbol.svg}" LargeGlyph="{dx:DXImage SvgImages/RichEdit/Symbol.svg}"/>
                        </dxr:RibbonPageGroup>
                    </dxr:RibbonPage>
                </dxr:RibbonDefaultPageCategory>
            </dxr:RibbonControl>
            <TextBlock Grid.Row="1" Grid.Column="0" Text="To:" Margin="12,12,4,4" HorizontalAlignment="Right"/>
            <dxe:TextEdit x:Name="emailAddressToEdit"  Grid.Row="1" Grid.Column="1" HorizontalAlignment="Stretch" Margin="0,12,12,4" EditValue="{Binding NewMessage.To, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}"/>
            <TextBlock Grid.Row="2" Grid.Column="0" Text="Subject:" Margin="12,12,4,4" HorizontalAlignment="Right"/>
            <dxe:TextEdit Grid.Row="2" Grid.Column="1" HorizontalAlignment="Stretch" Margin="0,12,12,4" EditValue="{Binding NewMessage.Subject, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
            <Border Grid.Row="3" Grid.ColumnSpan="2" BorderThickness="0,1,0,0" Margin="0,8,0,0">
                <Border.BorderBrush>
                    <DynamicResource ResourceKey="{dxt:BrushesThemeKey ResourceKey=PanelBorder}"/>
                </Border.BorderBrush>
                <dxre:RichEditControl BarManager="{Binding ElementName=barManager, Mode=OneTime}" x:Name="richEdit" Loaded="OnRichEditLoaded"
                                      Ribbon="{Binding ElementName=ribbon, Mode=OneTime}" ActiveViewType="Simple" ShowBorder="False"
                                      Content="{Binding NewMessage.Text, Converter={StaticResource MhtToContentConverter}, Mode=TwoWay}"/>
            </Border>
        </Grid>
    </dxb:BarManager>
</UserControl>