<local:GanttDemoModule x:Class="GanttDemo.Printing"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:dxgn="http://schemas.devexpress.com/winfx/2008/xaml/gantt"
      xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm"
      xmlns:local="clr-namespace:GanttDemo"
      xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
      xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
      xmlns:sys="clr-namespace:System;assembly=mscorlib"
      mc:Ignorable="d"
      d:DesignHeight="600"
      d:DesignWidth="1200">
    <local:GanttDemoModule.DataContext>
        <local:PrintingViewModel />
    </local:GanttDemoModule.DataContext>
    <local:GanttDemoModule.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/GanttDemo;component/ModuleResources/PrintDemoModuleResources.xaml" />
            </ResourceDictionary.MergedDictionaries>
            <dxmvvm:ObjectToObjectConverter x:Key="DateRangeConverter" DefaultSource="All" DefaultTarget="{x:Null}">
                <dxmvvm:MapItem Source="First Year" Target="(08/11/2020)-(08/11/2021)" />
                <dxmvvm:MapItem Source="First Month" Target="(08/11/2020)-(09/11/2020)" />
            </dxmvvm:ObjectToObjectConverter>
            <!--#region Grayscale printing resources-->
            <Style x:Key="summaryTaskGrayscaleStyle" TargetType="{x:Type dxgn:GanttSummaryTaskControl}">
                <Setter Property="Background" Value="DarkGray"/>
                <Setter Property="ProgressBackground" Value="Black"/>
            </Style>
            <Style x:Key="taskGrayscaleStyle" TargetType="{x:Type dxgn:GanttTaskControl}">
                <Setter Property="Background" Value="DarkGray"/>
                <Setter Property="ProgressBackground" Value="Black"/>
            </Style>
            <Style x:Key="connectorGrayscaleStyle" TargetType="{x:Type dxgn:GanttConnector}">
                <Setter Property="Stroke" Value="Black"/>
            </Style>
            <Style x:Key="resourceGrayscaleStyle" TargetType="{x:Type dxgn:GanttResourceControl}">
                <Setter Property="Foreground" Value="Black"/>
                <Setter Property="Background" Value="LightGray"/>
                <Setter Property="BorderBrush" Value="Gray"/>
            </Style>
            <!--#endregion-->
        </ResourceDictionary>
    </local:GanttDemoModule.Resources>
    <DockPanel>
        <local:GanttDemoRibbon DockPanel.Dock="Top" ExportGantt="{x:Reference gantt}" />
        <!--#region Options-->
        <ScrollViewer HorizontalScrollBarVisibility="Disabled"
                      VerticalScrollBarVisibility="Auto"
                      Name="PART_Options"
                      DockPanel.Dock="Right"
                      dx:ScrollBarExtensions.ScrollBarMode="TouchOverlap"
                      Focusable="False">
            <StackPanel Margin="12,0,12,12" MinWidth="210">
                <StackPanel.Resources>
                    <Style TargetType="GroupBox">
                        <Setter Property="Margin" Value="0,5,0,0" />
                    </Style>
                </StackPanel.Resources>
                <GroupBox Header="Print Date Range">
                    <dxe:ListBoxEdit x:Name="lbPrintDateLange" SelectedIndex="1" ShowBorder="False" StyleSettings="{dxe:RadioListBoxEditStyleSettings}">
                        <dxe:ListBoxEdit.ItemsSource>
                            <x:Array Type="{x:Type sys:String}">
                                <sys:String>All</sys:String>
                                <sys:String>First Year</sys:String>
                                <sys:String>First Month</sys:String>
                            </x:Array>
                        </dxe:ListBoxEdit.ItemsSource>
                    </dxe:ListBoxEdit>
                </GroupBox>
                <GroupBox Header="Print Style">
                    <dxe:ListBoxEdit x:Name="lbPrintStyle" SelectedIndex="0" ShowBorder="False" StyleSettings="{dxe:RadioListBoxEditStyleSettings}">
                        <dxe:ListBoxEdit.ItemsSource>
                            <x:Array Type="{x:Type sys:String}">
                                <sys:String>Default</sys:String>
                                <sys:String>Grayscale</sys:String>
                            </x:Array>
                        </dxe:ListBoxEdit.ItemsSource>
                    </dxe:ListBoxEdit>
                </GroupBox>
                <dxe:CheckEdit x:Name="chbPrintHeadersOnFirstPageOnly" Margin="0,5,0,0"
                                       IsChecked="True"
                                       Content="Print Headers On First Page Only" />
                <Button Command="{Binding ShowPreviewInNewTabCommand}" Margin="0,12,0,0" Content="Preview" />
                <Button Command="{Binding Commands.ShowRibbonPrintPreviewDialog, ElementName=ganttView}" Margin="0,12,0,0" Content="Preview in New Window" />
            </StackPanel>
        </ScrollViewer>
        <!--#endregion-->
        <dx:DXTabControl Style="{StaticResource tabControlPrintPreviewStyle}">
            <dx:DXTabItem Style="{StaticResource gridControlTabItemStyle}" Header="Gantt Control">
                <dxgn:GanttControl x:Name="gantt" ItemsSource="{Binding Items}" ShowBorder="False">
                    <dxgn:GanttControl.Columns>
                        <dxgn:GanttColumn BindTo="Name" Width="250" />
                    </dxgn:GanttControl.Columns>
                    <dxgn:GanttControl.View>
                        <dxgn:GanttView x:Name="ganttView"
                                        ResourcesSource="{Binding Resources}"
                                        Zoom="0:45:00"
                                        AutoExpandAllNodes="True"
                                        PrintHeadersOnFirstPageOnly="{Binding IsChecked, ElementName=chbPrintHeadersOnFirstPageOnly}"
                                        PrintDateRange="{Binding EditValue, ElementName=lbPrintDateLange, Converter={StaticResource DateRangeConverter}}"
                                        Loaded="{DXEvent Handler='@s.ScheduleAll()'}">
                            <dxmvvm:Interaction.Behaviors>
                                <local:PrintableTabBehavior PrintableControl="{Binding PrintableControl, Mode=OneWayToSource}" ShowPreviewTab="{Binding ReOpenPreviewTabsCommand}" />
                            </dxmvvm:Interaction.Behaviors>
                            <!--#region Grayscale printing support-->
                            <dxgn:GanttView.Style>
                                <Style TargetType="{x:Type dxgn:GanttView}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding EditValue, ElementName=lbPrintStyle}" Value="Grayscale">
                                            <Setter Property="PrintSummaryTaskStyle" Value="{StaticResource summaryTaskGrayscaleStyle}" />
                                            <Setter Property="PrintTaskStyle" Value="{StaticResource taskGrayscaleStyle}" />
                                            <Setter Property="PrintConnectorStyle" Value="{StaticResource connectorGrayscaleStyle}" />
                                            <Setter Property="PrintResourceStyle" Value="{StaticResource resourceGrayscaleStyle}" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </dxgn:GanttView.Style>
                            <!--#endregion-->
                        </dxgn:GanttView>
                    </dxgn:GanttControl.View>
                </dxgn:GanttControl>
            </dx:DXTabItem>
        </dx:DXTabControl>

    </DockPanel>
</local:GanttDemoModule>